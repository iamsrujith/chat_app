{% extends 'base.html' %}
{% load static %}
{% block content %}
<h1>home</h1>
{{ request.user.id|json_script:"user" }}
<div id="online-status">
    <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" id="fchat/2-1lexSwitchCheckChecked" name="status" checked>
        <label class="form-check-label" for="flexSwitchCheckChecked" id="statusLabel">Online</label>
    </div>
</div>
<div>
    <a id="joinChat" href="{% url 'connect' %}">Join chat</a>
</div>

<!--<a href="{% url 'chat' room_name='hihi' %}">Join chat</a>-->
{% endblock %}
{% block script %}
<script>
    $(document).ready(function() {
      var user = {{ user.pk }};
      $('#flexSwitchCheckChecked').change(function() {
        console.log("checked");
        var isChecked = $(this).prop('checked');

        $.ajax({
          url: '/update-status/',
          method: 'GET',
          data: {
            status: isChecked ? 'on' : 'off',
            user: user,
          },
          success: function(response) {
            $('#statusLabel').text(response);
            console.log(response);
          },
          error: function(xhr, status, error) {
            console.error(error);
          }
        });
      });

<!--      $('#joinChat').click(function() {-->
<!--        console.log("join chat clicked");-->

<!--        $.ajax({-->
<!--          url: '/match-user/',-->
<!--          method: 'GET',-->
<!--          data: {-->
<!--            user: user,-->
<!--          },-->
<!--          success: function(response) {-->
<!--            console.log(response);-->
<!--            if (response) {-->
<!--              chat_room = response-->
<!--              window.location.href = response;-->
<!--            }-->
<!--            console.log(chat_room, "+++")-->
<!--          },-->
<!--          error: function(xhr, status, error) {-->
<!--            console.error(error);-->
<!--          }-->
<!--        });-->
<!--      });-->
    });
</script>
{% endblock %}
